{
  "$schema": "http://json-schema.org/draft-07/schema#",
  "title": "LeadExtractionSchema",
  "type": "object",
  "properties": {
    "contact": {
      "type": "object",
      "properties": {
        "name": {"type": ["string", "null"]},
        "phone": {"type": ["string", "null"], "pattern": "^\\+?[1-9]\\d{1,14}$|^null$"},
        "email": {"type": ["string", "null"], "format": "email"},
        "preferred_contact_method": {
          "type": ["string", "null"],
          "enum": ["phone", "email", "text", "whatsapp", null]
        }
      },
      "additionalProperties": false
    },
    "property": {
      "type": "object",
      "properties": {
        "address": {"type": ["string", "null"]},
        "city": {"type": ["string", "null"]},
        "state": {"type": ["string", "null"]},
        "zip_code": {"type": ["string", "null"], "pattern": "^\\d{5}(-\\d{4})?$|^null$"},
        "property_type": {
          "type": ["string", "null"],
          "enum": ["single_family", "multi_family", "condo", "townhouse", "land", "commercial", "other", null]
        },
        "bedrooms": {"type": ["integer", "null"], "minimum": 0},
        "bathrooms": {"type": ["number", "null"], "minimum": 0},
        "square_feet": {"type": ["integer", "null"], "minimum": 0},
        "year_built": {"type": ["integer", "null"], "minimum": 1800, "maximum": 2100},
        "condition": {
          "type": ["string", "null"],
          "enum": ["excellent", "good", "fair", "poor", "needs_major_repair", null]
        }
      },
      "additionalProperties": false
    },
    "situation": {
      "type": "object",
      "properties": {
        "motivation": {
          "type": ["string", "null"],
          "enum": ["foreclosure", "divorce", "inherited", "downsizing", "relocating", "financial_hardship", "tired_landlord", "other", null]
        },
        "urgency": {
          "type": ["string", "null"],
          "enum": ["immediate", "within_30_days", "within_90_days", "flexible", null]
        },
        "occupancy_status": {
          "type": ["string", "null"],
          "enum": ["owner_occupied", "tenant_occupied", "vacant", null]
        },
        "mortgage_status": {
          "type": ["string", "null"],
          "enum": ["paid_off", "current", "behind", "in_foreclosure", null]
        },
        "asking_price": {"type": ["integer", "null"], "minimum": 0},
        "repairs_needed": {"type": ["boolean", "null"]},
        "open_to_cash_offer": {"type": ["boolean", "null"]}
      },
      "additionalProperties": false
    },
    "intent": {
      "type": "object",
      "properties": {
        "classification": {
          "type": "string",
          "enum": ["qualified_lead", "needs_more_info", "not_interested", "spam", "unclear"]
        },
        "confidence": {"type": "number", "minimum": 0, "maximum": 1},
        "next_action": {
          "type": ["string", "null"],
          "enum": ["schedule_call", "request_photos", "send_info", "follow_up", "close_conversation", null]
        }
      },
      "required": ["classification", "confidence"],
      "additionalProperties": false
    },
    "metadata": {
      "type": "object",
      "properties": {
        "language": {"type": "string", "default": "en"},
        "sentiment": {
          "type": "string",
          "enum": ["positive", "neutral", "negative", "frustrated", "urgent"]
        },
        "contains_pii": {"type": "boolean"},
        "extraction_notes": {"type": ["string", "null"], "maxLength": 500}
      },
      "required": ["language", "sentiment", "contains_pii"],
      "additionalProperties": false
    }
  },
  "required": ["contact", "property", "situation", "intent", "metadata"],
  "additionalProperties": false
}

